<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>US Political Dashboard 2025</title>
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />

    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;800&display=swap" rel="stylesheet">

    <style>
        /* --- 1. GLOBAL & LAYOUT --- */
        body, html {
            height: 100%;
            margin: 0;
            background-color: #050505;
            font-family: 'Inter', sans-serif;
            overflow: hidden; /* Prevent scrollbars */
        }

        #map {
            height: 100vh;
            width: 100%;
            z-index: 1;
            background: #050505; /* Fallback */
        }

        /* --- 2. GLASSMORPHISM UI ELEMENTS --- */

        /* The Title Card */
        .glass-header {
            position: absolute;
            top: 20px;
            left: 20px;
            z-index: 1000;
            width: 300px;
            padding: 20px;

            /* The Frost Effect */
            background: rgba(20, 20, 20, 0.6);
            backdrop-filter: blur(12px);
            -webkit-backdrop-filter: blur(12px);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 16px;
            box-shadow: 0 8px 32px 0 rgba(0, 0, 0, 0.5);

            color: white;
            pointer-events: none; /* Let clicks pass through, except text */
        }

        .glass-header h1 {
            margin: 0;
            font-size: 24px;
            font-weight: 800;
            letter-spacing: -0.5px;
            background: linear-gradient(90deg, #fff, #aaa);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }

        .glass-header p {
            margin: 5px 0 0 0;
            font-size: 13px;
            color: #888;
        }

        /* The Info Sidebar (Hidden by default) */
        .info-sidebar {
            position: absolute;
            top: 20px;
            right: -400px; /* Hidden off-screen */
            bottom: 20px;
            width: 320px;
            z-index: 1001;

            /* Frost Effect */
            background: rgba(15, 15, 15, 0.75);
            backdrop-filter: blur(15px);
            -webkit-backdrop-filter: blur(15px);
            border-left: 1px solid rgba(255, 255, 255, 0.08);
            border-radius: 20px 0 0 20px;
            box-shadow: -10px 0 40px rgba(0,0,0,0.8);

            padding: 30px;
            color: white;
            transition: right 0.4s cubic-bezier(0.22, 1, 0.36, 1); /* Smooth slide animation */
            display: flex;
            flex-direction: column;
        }

        .info-sidebar.active {
            right: 0; /* Slide in */
        }

        /* Sidebar Content Styling */
        .state-badge {
            display: inline-block;
            padding: 4px 12px;
            border-radius: 50px;
            font-size: 12px;
            font-weight: 600;
            margin-bottom: 10px;
            text-transform: uppercase;
        }
        .badge-dem { background: rgba(0, 102, 255, 0.2); color: #4d94ff; border: 1px solid rgba(0, 102, 255, 0.4); }
        .badge-rep { background: rgba(255, 51, 51, 0.2); color: #ff6666; border: 1px solid rgba(255, 51, 51, 0.4); }

        .sidebar-title { font-size: 32px; font-weight: 800; margin: 0 0 20px 0; }

        .data-section { margin-bottom: 25px; border-bottom: 1px solid rgba(255,255,255,0.1); padding-bottom: 15px; }
        .data-label { font-size: 11px; text-transform: uppercase; letter-spacing: 1px; color: #666; margin-bottom: 8px; }
        .data-value { font-size: 16px; font-weight: 500; }

        .members-list { list-style: none; padding: 0; margin: 0; max-height: 300px; overflow-y: auto; }
        .members-list li {
            padding: 10px;
            background: rgba(255,255,255,0.03);
            margin-bottom: 8px;
            border-radius: 8px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            font-size: 14px;
        }
        .party-dot { width: 8px; height: 8px; border-radius: 50%; display: inline-block; }

        /* Custom Scrollbar */
        ::-webkit-scrollbar { width: 6px; }
        ::-webkit-scrollbar-track { background: transparent; }
        ::-webkit-scrollbar-thumb { background: #333; border-radius: 3px; }

    </style>
</head>
<body>

    <div class="glass-header">
        <h1>US Governance Map</h1>
        <p>Select a state to view legislative composition.</p>
    </div>

    <div id="sidebar" class="info-sidebar">
        <div id="sidebar-content">
            </div>
    </div>

    <div id="map"></div>

    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
    <script>
        // --- 1. INITIALIZE MAP & DARK BASEMAP ---

        var map = L.map('map', {
            zoomControl: false,
            attributionControl: false,
            center: [37.8, -96],
            zoom: 4
        });

        // **CRITICAL**: This is the "Dark Matter" tile layer.
        // It gives that detailed, dark tech look you see in high-end dashboards.
        L.tileLayer('https://{s}.basemaps.cartocdn.com/dark_all/{z}/{x}/{y}{r}.png', {
            subdomains: 'abcd',
            maxZoom: 19
        }).addTo(map);


        // --- 2. MOCK DATA (Political Details) ---
        // In a real app, you'd fetch this from an API. Here are a few examples.
        const statePolitics = {
            "California": {
                gov: "Democrat",
                senate: ["Alex Padilla (D)", "Laphonza Butler (D)"],
                houseSplit: "40 D / 12 R",
                description: "Stronghold for the Democratic party with significant influence in tech policy."
            },
            "Texas": {
                gov: "Republican",
                senate: ["John Cornyn (R)", "Ted Cruz (R)"],
                houseSplit: "13 D / 25 R",
                description: "Traditionally Republican, focusing on energy and border security legislation."
            },
            "New York": {
                gov: "Democrat",
                senate: ["Chuck Schumer (D)", "Kirsten Gillibrand (D)"],
                houseSplit: "19 D / 7 R",
                description: "Key financial hub with a progressive legislative agenda."
            },
            "Florida": {
                gov: "Republican",
                senate: ["Marco Rubio (R)", "Rick Scott (R)"],
                houseSplit: "8 D / 20 R",
                description: "A rapidly growing state with a strong Republican legislative supermajority."
            }
        };

        // Generic data for states not listed above
        function getMockData(stateName, party) {
            if (statePolitics[stateName]) return statePolitics[stateName];

            // Generate believable fake data for the rest
            const s1 = party === 'D' ? `Senator A. Smith (D)` : `Senator J. Doe (R)`;
            const s2 = party === 'D' ? `Senator B. Jones (D)` : `Senator M. Ray (R)`;
            return {
                gov: party === 'D' ? "Democrat" : "Republican",
                senate: [s1, s2],
                houseSplit: party === 'D' ? "4 D / 2 R" : "2 D / 4 R",
                description: `Standard legislative profile for ${stateName}.`
            };
        }


        // --- 3. STYLING LOGIC ---

        // Party Affiliation Map
        const partyData = {
            "Alabama": "R", "Alaska": "R", "Arizona": "D", "Arkansas": "R", "California": "D", "Colorado": "D",
            "Connecticut": "D", "Delaware": "D", "Florida": "R", "Georgia": "R", "Hawaii": "D", "Idaho": "R",
            "Illinois": "D", "Indiana": "R", "Iowa": "R", "Kansas": "D", "Kentucky": "D", "Louisiana": "R",
            "Maine": "D", "Maryland": "D", "Massachusetts": "D", "Michigan": "D", "Minnesota": "D", "Mississippi": "R",
            "Missouri": "R", "Montana": "R", "Nebraska": "R", "Nevada": "R", "New Hampshire": "R", "New Jersey": "D",
            "New Mexico": "D", "New York": "D", "North Carolina": "D", "North Dakota": "R", "Ohio": "R", "Oklahoma": "R",
            "Oregon": "D", "Pennsylvania": "D", "Rhode Island": "D", "South Carolina": "R", "South Dakota": "R",
            "Tennessee": "R", "Texas": "R", "Utah": "R", "Vermont": "R", "Virginia": "R", "Washington": "D",
            "West Virginia": "R", "Wisconsin": "D", "Wyoming": "R"
        };

        function getColor(stateName) {
            const party = partyData[stateName];
            // Neon Blue and Neon Red
            return party === 'D' ? '#007bff' : party === 'R' ? '#ff2e2e' : '#666';
        }

        function style(feature) {
            return {
                fillColor: getColor(feature.properties.name),
                weight: 1.5,
                opacity: 1,
                color: getColor(feature.properties.name), // Border matches fill
                dashArray: '',
                fillOpacity: 0.15 // **Very sheer fill** to see the basemap texture (Glassy look)
            };
        }


        // --- 4. INTERACTION LOGIC ---

        function highlightFeature(e) {
            var layer = e.target;
            var color = layer.options.color;

            layer.setStyle({
                weight: 3,
                color: '#fff', // White border on hover
                fillOpacity: 0.4, // Brighter fill
                shadowBlur: 10
            });

            if (!L.Browser.ie && !L.Browser.opera && !L.Browser.edge) {
                layer.bringToFront();
            }
        }

        function resetHighlight(e) {
            geojson.resetStyle(e.target);
        }

        function zoomToFeature(e) {
            var layer = e.target;
            var stateName = layer.feature.properties.name;
            var party = partyData[stateName] || "Unknown";

            // 1. Map Animation
            map.flyToBounds(layer.getBounds(), { padding: [50, 50], duration: 1.5 });

            // 2. Update Sidebar Data
            updateSidebar(stateName, party);

            // 3. Show Sidebar
            document.getElementById('sidebar').classList.add('active');
        }

        function onEachFeature(feature, layer) {
            layer.on({
                mouseover: highlightFeature,
                mouseout: resetHighlight,
                click: zoomToFeature
            });
        }

        // --- 5. SIDEBAR LOGIC ---

        function updateSidebar(stateName, party) {
            const data = getMockData(stateName, party);
            const badgeClass = party === 'R' ? 'badge-rep' : 'badge-dem';

            const html = `
                <span class="state-badge ${badgeClass}">Governor: ${data.gov}</span>
                <h2 class="sidebar-title">${stateName}</h2>

                <div class="data-section">
                    <div class="data-label">House Split</div>
                    <div class="data-value">${data.houseSplit}</div>
                </div>

                <div class="data-section">
                    <div class="data-label">Senate Delegation</div>
                    <ul class="members-list">
                        ${data.senate.map(sen => `
                            <li>
                                ${sen}
                                <span class="party-dot" style="background:${party==='R'?'#ff2e2e':'#007bff'}"></span>
                            </li>
                        `).join('')}
                    </ul>
                </div>

                <div class="data-section">
                    <div class="data-label">Overview</div>
                    <div style="font-size: 14px; line-height: 1.6; color: #ccc;">
                        ${data.description}
                    </div>
                </div>
            `;

            document.getElementById('sidebar-content').innerHTML = html;
        }

        // Close sidebar on map click (background)
        map.on('click', function(e) {
            // Only close if we didn't click a feature (requires checking target)
            // Simplified: clicking the dark ocean zooms out
             if (e.originalEvent.target.id === 'map') {
                 document.getElementById('sidebar').classList.remove('active');
                 map.flyTo([37.8, -96], 4);
             }
        });


        // --- 6. LOAD DATA ---
        fetch('https://raw.githubusercontent.com/PublicaMundi/MappingAPI/master/data/geojson/us-states.json')
            .then(res => res.json())
            .then(data => {
                geojson = L.geoJson(data, {
                    style: style,
                    onEachFeature: onEachFeature
                }).addTo(map);
            });

    </script>
</body>
</html>
